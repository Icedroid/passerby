function setProductType(a){$('input[name="product_type"]').val(a)}function setAmount(a){$('input[name="amount"]').val(a)}function displayMoneyPoint(a,b){$("input[name='pay_way']:checked").val()==hkpay?(a=round(parseFloat(a)*rmbToDollar).toString(),$("#currency").text("美元")):$("#currency").text("元"),$("#price").text(a),$("#bonus").text(b)}function round(a){return(Math.round(100*a)/100).toFixed(2)}function changePointAmount(a,b,c){var d=pointProduct,e=d.par,f=parseInt(parseInt(a,10)/e);if(setProductType(d.id),isNaN(f)||0>=f||f>maxPointAmout||f%pointSaleBase!=0||b&&f.toString()!=a)return setAmount(""),displayMoneyPoint("0.00","0"),$(".amount_error").show(),c&&hideCheck(),void disableNextBtn();setAmount(f);var g=f*d.sale_price,h=f*d.par;displayMoneyPoint(g.toFixed(2).toString(),h.toString()),$(".amount_error").hide(),c&&showCheck(),enableNextBtn()}function changeCardAmount(){var a=0,b=$("#card_amount"),c=parseInt(b.val(),10);!isNaN(c)&&c.toString()==b.val()&&c>0?(setAmount(c),a++):setAmount("");var b=$(".card_type_label.click");if(b.length>0?(p=cardProducts[b.attr("product_type_id")],setProductType(p.id),a++):setProductType(""),2==a){var d=c*p.sale_price,e=c*p.par;if(d<=maxCardMoney)return displayMoneyPoint(d.toFixed(2).toString(),e.toString()),hideCardAmountError(),void enableNextBtn();setAmount("")}displayMoneyPoint("0.00","0"),showCardAmountError(),disableNextBtn()}function addErrorMsg(a){if($("#error").text().length>0)var b=$("#error").text()+"<br>"+a;else var b=a;$("#error").text(b)}function checkBillForm(){if($("#error").text(""),!$("#amount").val())return addErrorMsg("请选择适合的购买数量！"),!1;if($("[name=reason]:checked").val()==specialReasonVal&&!$("[name=special_ac]:checked").val())return addErrorMsg("请选择要充值的游戏！"),!1;if(!$("#product_type").val())return addErrorMsg("请选择要购买的点卡类型！"),!1;if(!$("input[name='pay_way']:checked").val())return addErrorMsg("请选择充值类型！"),!1;if($("input[name='pay_way']:checked").val()==bank_pay&&!$("#bank_code").val())return addErrorMsg("请选择银行！"),!1;if($("input[name='pay_way']:checked").val()==hkpay&&!$("input[name='hkpay_method']").val())return addErrorMsg("请选择海外支付渠道！"),!1;var a=parseInt($("#amount").val());if(a.toString()!=$("#amount").val())return $(".amount_error").show(),!1;if($("#card_pwd_input")[0]&&$("#card_pwd_input")[0].checked){var b=parseInt(cardProducts[$("#product_type").val()].sale_price),c=a*b;if(c>maxCardMoney)return showCardAmountError(),!1}else if(a.toString()!=$("#amount").val()||a<pointSaleBase||a>maxPointAmout||a%pointSaleBase!=0)return $(".amount_error").show(),!1;return $("#billForm").submit(),!0}function showCardAmountError(){$("#card_amount_tip").css("color","#d21b35")}function hideCardAmountError(){$("#card_amount_tip").css("color","#999999")}function disableNextBtn(){$("#next_btn").attr("disabled","disabled"),$("#next_btn").addClass("disabled")}function enableNextBtn(){$("#next_btn").removeAttr("disabled"),$("#next_btn").removeClass("disabled")}function checkPayMethod(){"abroad_bank"==$("input[name='pay_way']:checked").attr("id")&&$('label[for="epay"]').click()}function hideCheck(){$(".point_else").removeClass("clickOn")}function showCheck(){$(".point_else").addClass("clickOn")}$(function(){$("#credit_input").click(function(){$(".tip3, .list0").hide(),$(".credit_tip, #credit_panel, #abroad_bank_label, #alipay_label").show(),$("#credit_panel").find(".point_amount_label:first").click()}),$("#consign_input").click(function(){$("#abroad_bank_label, #abroad_bank_list").hide(),$(".tip3, .list0").hide(),$(".consign_tip, #consign_panel, #alipay_label").show(),$("#consign_panel").find(".point_amount_label:first").click(),checkPayMethod()}),$("#special_input").click(function(){$("#abroad_bank_label, #abroad_bank_list").hide(),$(".tip3, .list0").hide(),$(".special_tip, #special_panel, #alipay_label").show(),$("#special_panel").find(".point_amount_label:first").click(),checkPayMethod()}),$("#card_pwd_input").click(function(){$("#abroad_bank_label, #abroad_bank_list").hide(),$("#alipay_label").hide(),$(".tip3, .list0").hide(),$(".card_pwd_tip, #card_pwd_panel").show(),$("#card_amount").val(1),$(".card_type_label:first").click(),checkPayMethod()}),$("#special").mouseenter(function(){$(this).find("input").attr("disabled")&&($(".tip3").hide(),$("#special_unavailable").show())}),$("#special").mouseleave(function(){if($(this).find("input").attr("disabled")){$("#special_unavailable").hide();var a=$('input[name="reason"]:checked').parents(".reason_li").attr("id");$("."+a+"_tip").show()}}),$(".point_amount_label").click(function(){var a=$(this);$(".point_amount_label.click, .card_type_label.click, .point_else.click").removeClass("click"),a.addClass("click"),changePointAmount(a.attr("amount")),hideCheck()}),$(".point_else").click(function(){var a=$(this);$(".point_amount_label.click, .card_type_label.click").removeClass("click"),a.addClass("click");var b=$(this).find(".amount_input");b.focus(),changePointAmount(b.val(),!0,!0)}),$(".amount_input").focus(function(){var a=$(this).parent(),b=$(this).parent().prev();a.removeClass("hide"),b.addClass("hide")}),$(".amount_input").blur(function(){var a=$(this).parent(),b=$(this).parent().prev();""==$(this).val()&&(a.addClass("hide"),b.removeClass("hide")),changePointAmount($(this).val(),!0)}),$(".card_type_label").click(function(){var a=$(this);$(".card_type_label.click").removeClass("click"),a.addClass("click"),changeCardAmount();var b=cardProducts[$("#product_type").val()],c=parseInt(maxCardMoney/parseInt(b.sale_price));$("#card_amount_tip").text(b.par+"点卡不超过"+c+"张")}),$(".pay_way").click(function(a){a.preventDefault(),$("#"+$(this).attr("for")).click(),$(".pay_way.click").removeClass("click"),$(this).addClass("click")}),$('label[for="epay"]').click(function(){$("#bank_list").hide(),$("#abroad_bank_list").hide(),$("#pay_method_div").hide(),$("[name=reason]:checked").val()==cardReasonVal?changeCardAmount():changePointAmount($('input[name="amount"]').val())}),$('label[for="bank"]').click(function(){$("#bank_list").show(),$("#pay_method_div").show(),$("#abroad_bank_list").hide(),$('input[name="bank"]').next().removeClass("click"),$('input[name="bank_code"]').val(""),$(".bank_label:first").click(),$("[name=reason]:checked").val()==cardReasonVal?changeCardAmount():changePointAmount($('input[name="amount"]').val())}),$('label[for="abroad_bank"]').click(function(){$("#bank_list").hide(),$("#pay_method_div").hide(),$("#abroad_bank_list").show(),$('input[name="bank"]').next().removeClass("click"),$('input[name="bank_code"]').val(""),$("#skrill_wlt").next().click(),"美元"!=$("#currency").text()&&displayMoneyPoint($("#price").text(),$("#bonus").text())}),$('label[for="alipay"]').click(function(){$("#bank_list").hide(),$("#abroad_bank_list").hide(),$("#pay_method_div").hide(),$("[name=reason]:checked").val()==cardReasonVal?changeCardAmount():changePointAmount($('input[name="amount"]').val())}),$('label[for="weixin"]').click(function(){$("#bank_list").hide(),$("#abroad_bank_list").hide(),$("#pay_method_div").hide(),$("[name=reason]:checked").val()==cardReasonVal?changeCardAmount():changePointAmount($('input[name="amount"]').val())}),$(".bank_label").click(function(){$('input[name="bank"]').next().removeClass("click"),$(this).addClass("click");var a=$(this).prev();"0000"==a.attr("credit")?($("#pay_deposit").click(),$("#pay_credit").attr("disabled","disabled")):$("#pay_credit").removeAttr("disabled");var b=a.attr($('input[name="pay_method"]:checked').val());$('input[name="bank_code"]').val(b)}),$('input[name="pay_method"]').click(function(){var a=$(".bank_label.click").prev(),b=a.attr($('input[name="pay_method"]:checked').val());$('input[name="bank_code"]').val(b)}),$(".hkpay_method").click(function(){$(".hkpay_method").removeClass("click"),$(this).addClass("click"),$(this).prev().click()}),$("#more_bank").click(function(){$(".bank_label").show(),$(this).hide()}),$("#next_btn").click(function(a){a.preventDefault(),checkBillForm()})});